<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>User Account</title>
  <!-- Include your CSS and other head elements here -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
  <div id="account-container">
    <h1>Account Information</h1>
    <div id="user-info">
      <p id="display-username">Username: <%= userInfo.username %></p>
      <button onclick="showUpdateForm('username')">Update User Name</button>
      <div id="update-username-form" class="update-form" style="display:none;">
        <form action="/user/update/username" method="post">
          <input type="text" name="username" placeholder="New Username" required>
          <input type="hidden" name="user_id" value="<%= userInfo.user_id %>"> <!-- Presuming user_id is available -->
          <input type="submit" value="Submit">
        </form>
      </div>

      <p id="display-email">Email: <%= userInfo.email %></p>
      <button onclick="showUpdateForm('email')">Update Email</button>
      <div id="update-email-form" class="update-form" style="display:none;">
        <form action="/user/update/email" method="post">
          <input type="text" name="email" placeholder="New Email" required>
          <input type="hidden" name="user_id" value="<%= userInfo.user_id %>">
          <input type="submit" value="Submit">
        </form>
      </div>

      <p id="display-gre_q">GRE Quantitative: <%= userInfo.gre_q %></p>
      <button onclick="showUpdateForm('gre_q')">Update GRE Quantitative</button>
      <div id="update-gre_q-form" class="update-form" style="display:none;">
        <form action="/user/update/gre_q" method="post">
          <input type="text" name="gre_q" placeholder="New GRE Quantitative" required>
          <input type="hidden" name="user_id" value="<%= userInfo.user_id %>">
          <input type="submit" value="Submit">
        </form>
      </div>

      <p id="display-gre_v">GRE Verbal: <%= userInfo.gre_v %></p>
      <button onclick="showUpdateForm('gre_v')">Update GRE Verbal</button>
      <div id="update-gre_v-form" class="update-form" style="display:none;">
        <form action="/user/update/gre_v" method="post">
          <input type="text" name="gre_v" placeholder="New GRE Verbal" required>
          <input type="hidden" name="user_id" value="<%= userInfo.user_id %>">
          <input type="submit" value="Submit">
        </form>
      </div>

      <p id="display-gre_awa">GRE Writing: <%= userInfo.gre_awa %></p>
      <button onclick="showUpdateForm('gre_awa')">Update GRE Writing</button>
      <div id="update-gre_awa-form" class="update-form" style="display:none;">
        <form action="/user/update/gre_awa" method="post">
          <input type="text" name="gre_awa" placeholder="New GRE Writing" required>
          <input type="hidden" name="user_id" value="<%= userInfo.user_id %>">
          <input type="submit" value="Submit">
        </form>
      </div>

      <p id="display-gpa">GPA: <%= userInfo.gpa %></p>
      <button onclick="showUpdateForm('gpa')">Update GPA</button>
      <div id="update-gpa-form" class="update-form" style="display:none;">
        <form action="/user/update/gpa" method="post">
          <input type="text" name="gpa" placeholder="New GPA" required>
          <input type="hidden" name="user_id" value="<%= userInfo.user_id %>">
          <input type="submit" value="Submit">
        </form>
      </div>

      <p id="display-status">Status: <%= userInfo.status %></p>
      <button onclick="showUpdateForm('status')">Update Status</button>
      <div id="update-status-form" class="update-form" style="display:none;">
        <form action="/user/update/status" method="post">
          <input type="text" name="status" placeholder="New Status" required>
          <input type="hidden" name="user_id" value="<%= userInfo.user_id %>">
          <input type="submit" value="Submit">
        </form>
      </div>

      <p id="display-dream_area">Dream Area: <%= userInfo.dream_area %></p>
      <button onclick="showUpdateForm('dream_area')">Update Dream Area</button>
      <div id="update-dream_area-form" class="update-form" style="display:none;">
        <form action="/user/update/dream_area" method="post">
          <input type="text" name="dream_area" placeholder="New Dream Area" required>
          <input type="hidden" name="user_id" value="<%= userInfo.user_id %>">
          <input type="submit" value="Submit">
        </form>
      </div>

      <div id="add-user-container">
        <h2>POST!</h2>
        <form id="add-user-form">
          <input type="text" name="user_id" placeholder="User ID" required>
          <input type="text" name="username" placeholder="Username" required>
          <input type="email" name="email" placeholder="Email" required>
          <input type="password" name="password" placeholder="Password" required>
          <input type="number" name="gre_q" placeholder="GRE Quantitative" required>
          <input type="number" name="gre_v" placeholder="GRE Verbal" required>
          <input type="number" name="gre_awa" placeholder="GRE Writing" required>
          <input type="number" step="0.01" name="gpa" placeholder="GPA" required>
          <input type="text" name="status" placeholder="Status" required>
          <input type="text" name="dream_area" placeholder="Dream Area" required>
          <button type="submit">Add User</button>
        </form>
      </div>
    </div>
  </div>

  <script>
    function displayUserInfo() {
      for (var key in userInfo) {
        if (userInfo.hasOwnProperty(key)) {
          $('#display-' + key).text(capitalizeFirstLetter(key) + ': ' + userInfo[key]);
        }
      }
    }

    function showUpdateForm(field) {
      console.log("dasdasd");
      // Hide all forms
      $('.update-form').hide();
      // Show the specific form for the field
      $('#update-' + field + '-form').css('display', 'block');
    }

  $(document).ready(function() {
    $('.update-form form').on('submit', function(e) {
      e.preventDefault();

      var form = $(this);
      $.ajax({
        type: 'POST',
        url: form.attr('action'),
        data: form.serialize(),
        success: function(response) {
          alert('Update successful.');
        },
        error: function(xhr) {
          alert('Error: ' + xhr.responseText);
        }
      });
    });
  });


      // Handling the new user form submission via AJAX
  $('#add-user-form').on('submit', function(e) {
    e.preventDefault();
    const formData = $(this).serialize();
    $.ajax({
      type: 'POST',
      url: '/user/post', // This is the route we will create in Express
      data: formData,
      success: function(response) {
        alert('POST successfully');
      },
      error: function(xhr, status, error) {
        alert('Error adding user: ' + xhr.responseJSON.message);
      }
    });
  });
  </script>
</body>
</html>
